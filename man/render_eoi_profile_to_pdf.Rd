% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate-eoi-profile.R
\name{render_eoi_profile_to_pdf}
\alias{render_eoi_profile_to_pdf}
\title{Render EOI Applicant Profiles to a Single PDF with TOC}
\usage{
render_eoi_profile_to_pdf(all_applicants_data, output_pdf_path)
}
\arguments{
\item{all_applicants_data}{A data frame where each row represents an applicant.
Each row should contain the necessary EOI data fields compatible with
what \code{\link{create_eoi_profile}} expects when processing a single applicant (as a list).}

\item{output_pdf_path}{Character string; the desired file path for the
output PDF document.}
}
\value{
Invisibly returns the \code{output_pdf_path} on successful PDF generation.
Stops with an error if Quarto CLI is not found or if rendering fails.
}
\description{
This function takes a data frame of applicant data, generates a Markdown profile
for each applicant using \code{\link{create_eoi_profile}}, concatenates these
profiles with page breaks, and then renders the combined content to a single PDF
document using Quarto with the Typst format. The resulting PDF includes a
table of contents. It checks for Quarto's availability and handles
temporary file creation and cleanup.
}
\examples{
\dontrun{
if (interactive() && !is.null(quarto::quarto_path())) {
  mock_applicants_df <- data.frame(
    title = c("Mr", "Dr"),
    given_name = c("John", "Jane"),
    surname = c("Smith", "Doe"),
    preferred_email = c("john.smith@example.com", "jane.doe@example.com"),
    preferred_units = c("INFO1000, DATA1001", "COMP2000, COMP2001"),
    availability_monday = c("Full Day", "Not available"),
    availability_tuesday = c("AM only", "Full Day"),
    availability_wednesday = c("Not available", "PM only"),
    availability_thursday = c("PM only", "Not available"),
    availability_friday = c("Full Day", "Full Day"),
    expertise_area = c("Data Analysis", "Machine Learning"),
    higher_education_degrees = c("MSc Data Science", "PhD Computer Science"),
    stringsAsFactors = FALSE
  )
  temp_pdf_file <- tempfile(fileext = ".pdf")
  render_eoi_profile_to_pdf(mock_applicants_df, temp_pdf_file)
  if (file.exists(temp_pdf_file)) {
    message("PDF generated: ", temp_pdf_file)
    # To open the PDF (platform dependent):
    # if (Sys.info()["sysname"] == "Darwin") system2("open", temp_pdf_file)
    # if (Sys.info()["sysname"] == "Windows") shell.exec(temp_pdf_file)
    # if (Sys.info()["sysname"] == "Linux") system2("xdg-open", temp_pdf_file)
  }
  unlink(temp_pdf_file) # Clean up
} else {
  message("Quarto not found or not in interactive session. Skipping PDF example.")
}
}
}
